Search.setIndex({"docnames": ["chmncc", "chmncc.config", "chmncc.dataset", "chmncc.debug", "chmncc.explanations", "chmncc.loss", "chmncc.networks", "chmncc.optimizers", "chmncc.revise", "chmncc.test", "chmncc.train", "chmncc.utils", "index", "modules"], "filenames": ["chmncc.rst", "chmncc.config.rst", "chmncc.dataset.rst", "chmncc.debug.rst", "chmncc.explanations.rst", "chmncc.loss.rst", "chmncc.networks.rst", "chmncc.optimizers.rst", "chmncc.revise.rst", "chmncc.test.rst", "chmncc.train.rst", "chmncc.utils.rst", "index.rst", "modules.rst"], "titles": ["chmncc package", "chmncc.config package", "chmncc.dataset package", "chmncc.debug package", "chmncc.explanations package", "chmncc.loss package", "chmncc.networks package", "chmncc.optimizers package", "chmncc.revise package", "chmncc.test package", "chmncc.train package", "chmncc.utils package", "C-HMCNN", "chmncc"], "terms": {"config": [0, 12, 13], "cifar_config": [0, 12, 13], "confund": [0, 12, 13], "old_config": [0, 12, 13], "dataset": [0, 13], "dataload": [0, 12, 13], "load_cifar": [0, 12, 13], "parser": [0, 12, 13], "arff_data": [0, 2, 12], "initialize_dataset": [0, 2, 12], "initialize_other_dataset": [0, 2, 12], "parse_arff": [0, 2, 12], "preproces_cifar": [0, 12, 13], "visualize_dataset": [0, 12, 13], "debug": [0, 12, 13], "explan": [0, 5, 12, 13], "gradient": [0, 5, 12, 13], "compute_integrated_gradi": [0, 4, 12], "output_gradi": [0, 4, 12], "loss": [0, 12, 13], "rrr": [0, 12, 13], "igrrrloss": [0, 5, 12], "_is_full_backward_hook": [0, 5, 12], "forward": [0, 5, 12], "train": [0, 2, 5, 13], "rrrloss": [0, 5, 12], "network": [0, 4, 7, 12, 13], "constrainedffnn": [0, 12, 13], "alexnet": [0, 12, 13], "lenet": [0, 12, 13], "resnet18": [0, 12, 13], "optim": [0, 12, 13], "adam": [0, 12, 13], "get_adam_optim": [0, 7, 12], "revis": [0, 12, 13], "test": [0, 2, 13], "util": [0, 12, 13], "cifar_help": [0, 12, 13], "main": [0, 1, 4, 5], "c": [0, 1], "hmcnn": 0, "project": [0, 12], "dictionari": 1, "cifar": [1, 12], "100": [1, 5, 12], "hierarchi": 1, "http": [1, 2, 4, 5, 12], "github": [1, 2, 4, 5, 12], "com": [1, 2, 4, 5, 12], "ugenteraan": 1, "deep_hierarchical_classif": 1, "blob": [1, 4, 5], "level_dict": 1, "py": [1, 4, 5], "which": 1, "specifi": 1, "appli": 1, "contain": 1, "old": 1, "configur": 1, "file": [1, 2, 12], "hmnn": 1, "from": [1, 2, 4, 5], "giunchiglia": [1, 2], "et": [1, 2, 5, 12], "al": [1, 2, 5, 12], "origin": [2, 12], "metadata": 2, "approach": [2, 7], "thi": [2, 5, 12], "code": [2, 4], "wa": [2, 12], "adapt": 2, "lucamasera": 2, "awx": 2, "class": [2, 5], "arff_fil": 2, "is_go": 2, "is_test": 2, "fals": 2, "sourc": [2, 4, 5, 7, 12], "base": [2, 4, 5, 12], "object": 2, "all": [2, 7, 12], "thei": [2, 4], "provid": [2, 12], "ar": [2, 4, 12], "arff": 2, "i": [2, 5, 12], "name": [2, 12], "str": 2, "dict": 2, "tupl": 2, "bool": [2, 5], "initi": 2, "paramet": [2, 4, 7, 12], "prepar": [2, 12], "list": [2, 12], "whether": [2, 5], "go": 2, "locat": 2, "valid": [2, 12], "data": [2, 4, 12], "return": [2, 4, 5, 7], "tensor": [2, 4], "digraph": 2, "pars": 2, "arf_fil": 2, "x": [2, 5], "torch": [2, 4, 5], "instanc": [2, 4], "y": [2, 5], "label": [2, 5, 12], "r": [2, 12], "adjac": 2, "matrix": [2, 5], "g": 2, "nx": 2, "graph": 2, "batch_x": 4, "batch_blank": 4, "model": [4, 5, 12], "integr": [4, 5], "comput": 4, "implement": [4, 12], "taken": [4, 5], "cvxtz": 4, "integratedgradientspytorch": 4, "mlp_gradient": 4, "batch": [4, 12], "zero": 4, "nn": [4, 5, 7], "integrated_gradi": [4, 5], "input": [4, 5], "pred": 4, "respect": [4, 12], "output": [4, 5], "grad": 4, "explain": [4, 12], "For": [4, 12], "now": [4, 12], "simpli": [4, 12], "grandient": 4, "net": [5, 7], "regularizer_r": 5, "base_criterion": 5, "function": [5, 12], "cross_entropi": 5, "weight": 5, "none": 5, "rr_clip": 5, "right": 5, "reason": 5, "propos": [5, 12], "ross": 5, "2017": 5, "minor": 5, "chang": 5, "see": [5, 12], "arxiv": 5, "org": 5, "ab": 5, "1703": 5, "03717": 5, "The": [5, 12], "calcul": 5, "predict": 5, "compar": 5, "ground": 5, "truth": 5, "user": 5, "ml": 5, "research": 5, "A": [5, 12], "typologi": 5, "explor": 5, "guid": 5, "explanatori": 5, "interact": 5, "machin": 5, "learn": [5, 7, 12], "xil_method": 5, "xil_loss": 5, "doi": 5, "2203": 5, "03668": 5, "one": [5, 12], "us": [5, 12], "part": 5, "option": 5, "expl": 5, "logit": 5, "confound": 5, "right_answer_loss": 5, "right_reason_loss": 5, "param": 5, "annot": 5, "mask": 5, "ones": 5, "penal": 5, "region": 5, "basic": 5, "samplei": 5, "lr": 7, "float": 7, "weight_decai": 7, "architectur": 7, "rate": [7, 12], "It": 7, "deal": [7, 12], "we": [7, 12], "have": [7, 12], "emploi": [7, 12], "experi": 7, "baselin": 12, "paper": 12, "coher": 12, "hierarch": 12, "multi": 12, "classif": 12, "later": 12, "expand": 12, "order": 12, "multipl": 12, "consist": 12, "layer": 12, "eleonora": 12, "thoma": 12, "samuel": 12, "bortolotti": 12, "current": 12, "develop": 12, "top": 12, "And": 12, "offer": 12, "possibl": 12, "exploit": 12, "both": 12, "introduc": 12, "follow": 12, "instruct": 12, "set": 12, "up": 12, "your": 12, "pc": 12, "moreov": 12, "facilit": 12, "applic": 12, "makefil": 12, "ha": 12, "been": 12, "its": 12, "call": 12, "appropri": 12, "help": 12, "command": 12, "gnu": 12, "make": 12, "git": 12, "samuelebortolotti": 12, "cd": 12, "hmncnn": 12, "pip": 12, "upgrad": 12, "txt": 12, "note": 12, "might": 12, "conveni": 12, "creat": 12, "virtual": 12, "enviro": 12, "handl": 12, "depend": 12, "simpl": 12, "wai": 12, "manag": 12, "python": 12, "environ": 12, "venv": 12, "In": 12, "sure": 12, "you": 12, "3": 12, "9": 12, "should": 12, "work": 12, "even": 12, "more": 12, "recent": 12, "version": 12, "howev": 12, "onli": 12, "env": 12, "chmncnn": 12, "bin": 12, "activ": 12, "rememb": 12, "deactiv": 12, "onc": 12, "finish": 12, "altern": 12, "can": 12, "conda": 12, "type": 12, "chmncc": 12, "hmcnn_env": 12, "yml": 12, "automat": 12, "sphinx": 12, "v4": 12, "5": 12, "0": 12, "avail": 12, "need": 12, "dev": 12, "sinc": 12, "quit": 12, "verbos": 12, "suggest": 12, "doc": 12, "layout": 12, "access": 12, "open": 12, "build": 12, "html": 12, "index": 12, "browser": 12, "equival": 12, "run": 12, "sake": 12, "complet": 12, "mai": 12, "want": 12, "full": 12, "here": 12, "quickstart": 12, "sep": 12, "batchfil": 12, "chmnnn": 12, "1": 12, "languag": 12, "en": 12, "extens": 12, "ext": 12, "autodoc": 12, "napoleon": 12, "viewcod": 12, "myst_pars": 12, "apidoc": 12, "p": 12, "o": 12, "execut": 12, "second": 12, "lead": 12, "slightli": 12, "differ": 12, "becaus": 12, "abov": 12, "do": 12, "custom": 12, "To": 12, "m": 12, "exp_nam": 12, "epochs_numb": 12, "dataset_nam": 12, "seed": 12, "seed_num": 12, "devic": 12, "device_num": 12, "size": 12, "batch_siz": 12, "test_batch_s": 12, "weigh": 12, "decai": 12, "dai": 12, "dry": 12, "entiti": 12, "wandb": 12, "true": 12, "exampl": 12, "exp_1": 12, "10": 12, "cellcycle_fun": 12, "pass": 12, "must": 12, "end": 12, "_fun": 12, "_go": 12, "_other": 12, "If": 12, "modifi": 12, "script": 12, "main_script": 12, "sh": 12, "result": 12, "written": 12, "folder": 12, "csv": 12, "again": 12, "accord": 12, "necess": 12, "titan": 12, "xp": 12, "12gb": 12, "memori": 12, "descript": 12, "given": 12, "hmcnn_enc": 12, "By": 12, "obtain": 12, "averag": 12, "over": 12, "255": 12, "derisi_fun": 12, "195": 12, "eisen_fun": 12, "306": 12, "expr_fun": 12, "302": 12, "gasch1_fun": 12, "286": 12, "gasch2_fun": 12, "258": 12, "seq_fun": 12, "292": 12, "spo_fun": 12, "215": 12, "cellcycle_go": 12, "413": 12, "derisi_go": 12, "370": 12, "eisen_go": 12, "455": 12, "expr_go": 12, "447": 12, "gasch1_go": 12, "436": 12, "gasch2_go": 12, "414": 12, "seq_go": 12, "446": 12, "spo_go": 12, "382": 12, "diatoms_oth": 12, "758": 12, "enron_oth": 12, "756": 12, "imclef07a_oth": 12, "956": 12, "imclef07d_oth": 12, "927": 12, "inproceed": 12, "giunchiglia2020neurip": 12, "titl": 12, "booktitl": 12, "34th": 12, "confer": 12, "neural": 12, "inform": 12, "process": 12, "system": 12, "neurip": 12, "2020": 12, "address": 12, "vancouv": 12, "canada": 12, "month": 12, "decemb": 12, "year": 12, "cnn": 12, "lenet5": 12, "cifar100": 12, "e": 12, "t": 12, "perform": 12, "an": 12, "first": 12, "therefor": 12, "download": 12, "filter": 12, "Or": 12, "after": 12, "readi": 12, "As": 12, "effect": 12, "represent": 12, "50": 12, "001": 12, "128": 12, "cuda": 12, "slurm": 12, "univers": 12, "cluster": 12, "packag": [12, 13], "subpackag": [12, 13], "submodul": [12, 13], "modul": [12, 13], "__main__": [12, 13], "page": 12, "content": 13}, "objects": {"": [[0, 0, 0, "-", "chmncc"]], "chmncc": [[1, 0, 0, "-", "config"], [3, 0, 0, "-", "debug"], [4, 0, 0, "-", "explanations"], [5, 0, 0, "-", "loss"], [7, 0, 0, "-", "optimizers"]], "chmncc.config": [[1, 0, 0, "-", "cifar_config"], [1, 0, 0, "-", "confunders"], [1, 0, 0, "-", "old_config"]], "chmncc.dataset": [[2, 0, 0, "-", "datasets"], [2, 0, 0, "-", "parser"]], "chmncc.dataset.parser": [[2, 1, 1, "", "arff_data"], [2, 2, 1, "", "initialize_dataset"], [2, 2, 1, "", "initialize_other_dataset"], [2, 2, 1, "", "parse_arff"]], "chmncc.explanations": [[4, 0, 0, "-", "gradients"]], "chmncc.explanations.gradients": [[4, 2, 1, "", "compute_integrated_gradient"], [4, 2, 1, "", "output_gradients"]], "chmncc.loss": [[5, 0, 0, "-", "RRR"]], "chmncc.loss.RRR": [[5, 1, 1, "", "IGRRRLoss"], [5, 1, 1, "", "RRRLoss"]], "chmncc.loss.RRR.IGRRRLoss": [[5, 3, 1, "", "_is_full_backward_hook"], [5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "chmncc.loss.RRR.RRRLoss": [[5, 3, 1, "", "_is_full_backward_hook"], [5, 4, 1, "", "forward"], [5, 3, 1, "", "training"]], "chmncc.optimizers": [[7, 0, 0, "-", "adam"]], "chmncc.optimizers.adam": [[7, 2, 1, "", "get_adam_optimizer"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:function", "3": "py:attribute", "4": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "function", "Python function"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"]}, "titleterms": {"chmncc": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13], "packag": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "subpackag": 0, "submodul": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "__main__": 0, "modul": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "content": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "config": 1, "cifar_config": 1, "confund": 1, "old_config": 1, "dataset": [2, 12], "dataload": 2, "load_cifar": 2, "parser": 2, "preproces_cifar": 2, "visualize_dataset": 2, "debug": 3, "explan": 4, "gradient": 4, "loss": 5, "rrr": 5, "network": 6, "constrainedffnn": 6, "alexnet": 6, "lenet": 6, "resnet18": 6, "optim": 7, "adam": 7, "revis": 8, "test": [9, 12], "train": [10, 12], "util": 11, "cifar_help": 11, "c": 12, "hmcnn": 12, "author": 12, "about": 12, "get": 12, "start": 12, "clone": 12, "repositori": 12, "instal": 12, "requir": 12, "gener": 12, "code": 12, "document": 12, "giunchiglia": 12, "lukasiewicz": 12, "approach": 12, "experi": 12, "hyperparamet": 12, "search": 12, "architectur": 12, "refer": 12, "our": 12, "indic": 12, "tabl": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"chmncc package": [[0, "chmncc-package"]], "Subpackages": [[0, "subpackages"]], "Submodules": [[0, "submodules"], [1, "submodules"], [2, "submodules"], [3, "submodules"], [4, "submodules"], [5, "submodules"], [6, "submodules"], [7, "submodules"], [8, "submodules"], [9, "submodules"], [10, "submodules"], [11, "submodules"]], "chmncc.__main__ module": [[0, "chmncc-main-module"]], "Module contents": [[0, "module-chmncc"], [1, "module-chmncc.config"], [2, "module-contents"], [3, "module-chmncc.debug"], [4, "module-chmncc.explanations"], [5, "module-chmncc.loss"], [6, "module-contents"], [7, "module-chmncc.optimizers"], [8, "module-contents"], [9, "module-contents"], [10, "module-contents"], [11, "module-contents"]], "chmncc.config package": [[1, "chmncc-config-package"]], "chmncc.config.cifar_config module": [[1, "module-chmncc.config.cifar_config"]], "chmncc.config.confunders module": [[1, "module-chmncc.config.confunders"]], "chmncc.config.old_config module": [[1, "module-chmncc.config.old_config"]], "chmncc.dataset package": [[2, "chmncc-dataset-package"]], "chmncc.dataset.dataloaders module": [[2, "chmncc-dataset-dataloaders-module"]], "chmncc.dataset.datasets module": [[2, "module-chmncc.dataset.datasets"]], "chmncc.dataset.load_cifar module": [[2, "chmncc-dataset-load-cifar-module"]], "chmncc.dataset.parser module": [[2, "module-chmncc.dataset.parser"]], "chmncc.dataset.preproces_cifar module": [[2, "chmncc-dataset-preproces-cifar-module"]], "chmncc.dataset.visualize_dataset module": [[2, "chmncc-dataset-visualize-dataset-module"]], "chmncc.debug package": [[3, "chmncc-debug-package"]], "chmncc.debug.debug module": [[3, "chmncc-debug-debug-module"]], "chmncc.explanations package": [[4, "chmncc-explanations-package"]], "chmncc.explanations.gradients module": [[4, "module-chmncc.explanations.gradients"]], "chmncc.loss package": [[5, "chmncc-loss-package"]], "chmncc.loss.RRR module": [[5, "module-chmncc.loss.RRR"]], "chmncc.networks package": [[6, "chmncc-networks-package"]], "chmncc.networks.ConstrainedFFNN module": [[6, "chmncc-networks-constrainedffnn-module"]], "chmncc.networks.alexnet module": [[6, "chmncc-networks-alexnet-module"]], "chmncc.networks.lenet module": [[6, "chmncc-networks-lenet-module"]], "chmncc.networks.resnet18 module": [[6, "chmncc-networks-resnet18-module"]], "chmncc.optimizers package": [[7, "chmncc-optimizers-package"]], "chmncc.optimizers.adam module": [[7, "module-chmncc.optimizers.adam"]], "chmncc.revise package": [[8, "chmncc-revise-package"]], "chmncc.revise.revise module": [[8, "chmncc-revise-revise-module"]], "chmncc.test package": [[9, "chmncc-test-package"]], "chmncc.test.test module": [[9, "chmncc-test-test-module"]], "chmncc.train package": [[10, "chmncc-train-package"]], "chmncc.train.train module": [[10, "chmncc-train-train-module"]], "chmncc.utils package": [[11, "chmncc-utils-package"]], "chmncc.utils.cifar_helper module": [[11, "chmncc-utils-cifar-helper-module"]], "chmncc.utils.utils module": [[11, "chmncc-utils-utils-module"]], "C-HMCNN": [[12, "c-hmcnn"]], "Author": [[12, "author"]], "About": [[12, "about"]], "Getting Started": [[12, "getting-started"]], "Clone the repository": [[12, "clone-the-repository"]], "Install the requirements": [[12, "install-the-requirements"]], "Generate the code documentation": [[12, "generate-the-code-documentation"]], "Giunchiglia and Lukasiewicz approach": [[12, "giunchiglia-and-lukasiewicz-approach"]], "Experiment": [[12, "experiment"]], "Hyperparameters search": [[12, "hyperparameters-search"]], "Architecture": [[12, "architecture"]], "Reference": [[12, "reference"]], "Our approach": [[12, "our-approach"]], "Dataset": [[12, "dataset"]], "Train and test": [[12, "train-and-test"]], "Contents:": [[12, null]], "Indices and tables": [[12, "indices-and-tables"]], "chmncc": [[13, "chmncc"]]}, "indexentries": {"chmncc": [[0, "module-chmncc"]], "module": [[0, "module-chmncc"], [1, "module-chmncc.config"], [1, "module-chmncc.config.cifar_config"], [1, "module-chmncc.config.confunders"], [1, "module-chmncc.config.old_config"], [2, "module-chmncc.dataset.datasets"], [2, "module-chmncc.dataset.parser"], [3, "module-chmncc.debug"], [4, "module-chmncc.explanations"], [4, "module-chmncc.explanations.gradients"], [5, "module-chmncc.loss"], [5, "module-chmncc.loss.RRR"], [7, "module-chmncc.optimizers"], [7, "module-chmncc.optimizers.adam"]], "chmncc.config": [[1, "module-chmncc.config"]], "chmncc.config.cifar_config": [[1, "module-chmncc.config.cifar_config"]], "chmncc.config.confunders": [[1, "module-chmncc.config.confunders"]], "chmncc.config.old_config": [[1, "module-chmncc.config.old_config"]], "arff_data (class in chmncc.dataset.parser)": [[2, "chmncc.dataset.parser.arff_data"]], "chmncc.dataset.datasets": [[2, "module-chmncc.dataset.datasets"]], "chmncc.dataset.parser": [[2, "module-chmncc.dataset.parser"]], "initialize_dataset() (in module chmncc.dataset.parser)": [[2, "chmncc.dataset.parser.initialize_dataset"]], "initialize_other_dataset() (in module chmncc.dataset.parser)": [[2, "chmncc.dataset.parser.initialize_other_dataset"]], "parse_arff() (in module chmncc.dataset.parser)": [[2, "chmncc.dataset.parser.parse_arff"]], "chmncc.debug": [[3, "module-chmncc.debug"]], "chmncc.explanations": [[4, "module-chmncc.explanations"]], "chmncc.explanations.gradients": [[4, "module-chmncc.explanations.gradients"]], "compute_integrated_gradient() (in module chmncc.explanations.gradients)": [[4, "chmncc.explanations.gradients.compute_integrated_gradient"]], "output_gradients() (in module chmncc.explanations.gradients)": [[4, "chmncc.explanations.gradients.output_gradients"]], "igrrrloss (class in chmncc.loss.rrr)": [[5, "chmncc.loss.RRR.IGRRRLoss"]], "rrrloss (class in chmncc.loss.rrr)": [[5, "chmncc.loss.RRR.RRRLoss"]], "_is_full_backward_hook (chmncc.loss.rrr.igrrrloss attribute)": [[5, "chmncc.loss.RRR.IGRRRLoss._is_full_backward_hook"]], "_is_full_backward_hook (chmncc.loss.rrr.rrrloss attribute)": [[5, "chmncc.loss.RRR.RRRLoss._is_full_backward_hook"]], "chmncc.loss": [[5, "module-chmncc.loss"]], "chmncc.loss.rrr": [[5, "module-chmncc.loss.RRR"]], "forward() (chmncc.loss.rrr.igrrrloss method)": [[5, "chmncc.loss.RRR.IGRRRLoss.forward"]], "forward() (chmncc.loss.rrr.rrrloss method)": [[5, "chmncc.loss.RRR.RRRLoss.forward"]], "training (chmncc.loss.rrr.igrrrloss attribute)": [[5, "chmncc.loss.RRR.IGRRRLoss.training"]], "training (chmncc.loss.rrr.rrrloss attribute)": [[5, "chmncc.loss.RRR.RRRLoss.training"]], "chmncc.optimizers": [[7, "module-chmncc.optimizers"]], "chmncc.optimizers.adam": [[7, "module-chmncc.optimizers.adam"]], "get_adam_optimizer() (in module chmncc.optimizers.adam)": [[7, "chmncc.optimizers.adam.get_adam_optimizer"]]}})